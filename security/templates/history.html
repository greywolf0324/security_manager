{% extends 'layouts/base.html' %}

{% block content %}

<div class="table-responsive container mt-5">
  <div class="row" style="margin-left: 40px">
    <div class="col-3">
      <label class="form-label">Filter</label>
      <select class="form-select" id="filter-option" name="filter-option">
        <option value="" disabled selected>select filter</option>
        <option>Customer Name</option>
        <option>User Name</option>
      </select>
    </div>    
  </div>
  <div class="row mt-4">
    <script>
      function toggleCheckboxes(masterCheckbox) {
        var checkboxes = document.getElementsByClassName("subCheckbox");
        for (var i = 0; i < checkboxes.length; i++) {
          checkboxes[i].checked = masterCheckbox.checked;
        }
      }
    
      function updateMasterCheckbox() {
        var masterCheckbox = document.getElementById("masterCheckbox");
        var checkboxes = document.getElementsByClassName("subCheckbox");
        masterCheckbox.checked = true;
        for (var i = 0; i < checkboxes.length; i++) {
          if (!checkboxes[i].checked) {
            masterCheckbox.checked = false;
            break;
          }
        }
      }
    </script>
    <style>
      #history thead, #history tbody tr {
          display: table;
          width: 100%;
          table-layout: fixed;
      }
      #history tbody {
          height: calc(100vh - 448px);
          table-layout: fixed;
          overflow: auto;
          display: block;
          width: 100%;
      }
      .container{
        max-width: 1324px !important;
      }
    </style>
    <table class="table" id="history">
      <thead>
        <tr>
          <th style="width: 5%;"><input type="checkbox" id="checkbox-all" name="checkbox" onchange="toggleCheckboxes(this)"></th>
          <th>Customer Name</th>
          <th>User Name</th>
          <th>
            Creation Date
          </th>
          <th class="text-center pe-5">PO Date</th>
          <th></th>
        </tr>
      </thead>

      {% if histories != "empty" %}
      <tbody>
        {% for history in histories %}
        <tr>
          <td style="width: 5%;"><input type="checkbox" class="subCheckbox" id="checkbox" name="checkbox" onchange="updateMasterCheckbox()"></td>
          <td>{{ history.0 }}</td>
          <td>{{ history.1 }}</td>
          <td>{{ history.2 }}</td>
          <td class="text-center">{{ history.3 }}</td>
          <td class="text-center">
            <form method="post">
              {% csrf_token %}
              <a type="submit" class="btn btn-primary" href="{% url 'security:history_view' history.2 %}"
                id="history_viewer">View</a>
            </form>
          </td>

        </tr>
        {% endfor %}
      </tbody>
      {% endif %}
    </table>
  </div>
  <div class="black-line" style = "width: 100%; height: 7px; background-color: darkslategray"></div>
  <div class="row mt-5">
      <div class="col-10"></div>
      <div class="col-2 d-flex align-items-end justify-content-start ps-5 ">
        <button class="btn btn-danger text-white w-50" id="delete-btn">Delete</button>
      </div>
  </div>
</div>


<script>
  console.log("{{ real }}", "____")
  console.log("{{ history }}", "____")
  console.log("{{ new.0.output }}", "____")
</script>
  {% endblock %}